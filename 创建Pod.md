### **创建 Pod 页面设计**

#### **页面路径**

```
/namespaces/{namespace}/create-pod
```

------

### **页面功能**

- 在指定命名空间下创建一个新的 Pod。
- 用户可以填写 Pod 的名称、镜像、端口、环境变量等配置。
- 支持多个容器的配置。

------

### **页面字段**

| 字段名称                 | 描述                  |
|----------------------|---------------------|
| Pod 名称 (name)        | 必填，Pod 的唯一标识。       |
| 容器列表 (containers)    | 至少需要配置一个容器。         |
| - 容器名称 (name)        | 容器的名称，必填。           |
| - 镜像 (image)         | 容器使用的镜像，必填。         |
| - 端口 (ports)         | 容器暴露的端口列表，非必填。      |
| - 环境变量 (environment) | 容器的环境变量配置，非必填。      |
| CPU 限制 (cpuLimits)   | 配置容器的 CPU 使用限制，非必填。 |
| 内存限制 (memoryLimits)  | 配置容器的内存使用限制，非必填。    |
| 卷 (volumes)          | 容器需要挂载的存储卷，非必填。     |

------

### **页面布局**

#### **1. 表单界面**

```less
less复制代码+----------------------------------+
| 创建 Pod                                    |
+---------------------------------------------+
| [基本信息]                                  |
| - Pod 名称: [           ]                   |
| - 命名空间: default                         |
+---------------------------------------------+
| [容器配置]                                  |
| 容器 1:                                     |
| - 容器名称: [container1       ]             |
| - 镜像:      [nginx:1.21         ]          |
| - 端口:      [+ 添加端口]                   |
|   - 端口 1: [80  ] 协议: [TCP] [删除按钮]   |
| - 环境变量: [+ 添加环境变量]                |
|   - 变量 1: KEY: [ENV1 ] VALUE: [VALUE1 ]   |
| - CPU 限制: [   1    ] (单位: 核心数)       |
| - 内存限制: [ 512Mi  ] (单位: Mi/Gi)        |
+---------------------------------------------+
| [+ 添加容器]                                |
+---------------------------------------------+
| [存储卷配置]                                |
| [+ 添加存储卷]                              |
| - 存储卷名称: [volume1]                     |
| - 挂载路径:   [/data    ]                   |
| - 类型:       [emptyDir] (支持NFS/ConfigMap)|
+---------------------------------------------+
| [创建按钮] [重置按钮]                       |
+---------------------------------------------+
```

------

### **交互功能**

1. **添加容器**：支持动态添加多个容器，每个容器有独立的镜像、端口、环境变量和资源限制。

2. **添加端口**：容器端口支持多个，可以指定协议 (TCP/UDP)。

3. **添加环境变量**：可以为每个容器添加多个键值对形式的环境变量。

4. **添加存储卷**：支持不同类型的卷 (emptyDir、ConfigMap、NFS)。

5. 表单校验

   ：

    - Pod 名称和容器名称必填且不能重复。
    - 镜像字段必填。
    - 端口和 CPU/内存限制需要校验合法性。

------

### **API 设计**

#### **创建 Pod**

- **方法**: `POST /api/namespaces/{namespace}/pods`

- **请求体**:

  ```json
  {
    "name": "example-pod",
    "namespace": "default",
    "containers": [
      {
        "name": "container1",
        "image": "nginx:1.21",
        "ports": [
          {"port": 80, "protocol": "TCP"}
        ],
        "environment": [
          {"name": "ENV1", "value": "VALUE1"}
        ],
        "resources": {
          "limits": {
            "cpu": "1",
            "memory": "512Mi"
          }
        }
      }
    ],
    "volumes": [
      {
        "name": "volume1",
        "mountPath": "/data",
        "type": "emptyDir"
      }
    ]
  }
  ```

- **响应**:

  ```json
  {
    "message": "Pod created successfully",
    "pod": {
      "name": "example-pod",
      "namespace": "default"
    }
  }
  ```

#### **错误响应**

- 如果字段缺失或格式错误：

  ```json
  {
    "error": "Invalid request",
    "details": "Pod name is required"
  }
  ```

------

### **前端逻辑设计**

1. **表单动态渲染**：
    - 使用 React 的状态管理动态生成容器、端口、环境变量和卷的表单字段。
    - 提交前将多层次数据结构组合成符合 API 要求的 JSON。
2. **表单校验**：
    - 使用 `react-hook-form` 或类似的库，实时校验必填字段和格式要求。
3. **API 调用**：
    - 提交时调用 `POST /api/namespaces/{namespace}/pods`。
    - 如果成功返回，则跳转到 Pod 列表页面 `/namespaces/{namespace}/pods`。
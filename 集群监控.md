### **集群监控页面设计**

#### **页面路径**

```
/monitor
```

------

### **页面功能**

- 展示 Kubernetes 集群的整体运行状况。
- 实时监控 CPU、内存等资源使用情况。
- 展示节点（Node）状态、命名空间（Namespace）资源分配情况。
- 提供整体和细化到节点或命名空间的监控视图。

------

### **页面字段**

| 字段名称                       | 描述                                       |
| ------------------------------ | ------------------------------------------ |
| 集群 CPU 使用率 (clusterCPU)   | 集群所有节点的 CPU 总使用率 (%)。          |
| 集群内存使用率 (clusterMemory) | 集群所有节点的内存总使用率 (%)。           |
| 节点列表 (nodes)               | 节点的资源使用详情，包括 CPU、内存使用等。 |
| 命名空间列表 (namespaces)      | 每个命名空间的资源使用情况。               |

------

### **页面布局**

#### **1. 监控概览**

```diff
+---------------------------------------------+
| 集群监控                                    |
+---------------------------------------------+
| 集群 CPU 使用率: 40%  ██████░░░░░           |
| 集群内存使用率: 60%  ████████░░░            |
| 当前节点数: 5                              |
| 当前命名空间数: 10                         |
+---------------------------------------------+
```

#### **2. 节点资源使用详情**

```lua
+---------------------------------------------+
| 节点资源使用详情                            |
+---------------------------------------------+
| 节点名称       | CPU 使用率   | 内存使用率   |
|----------------|-------------|-------------|
| node-1         | 50% ████░░░░| 70% █████░░ |
| node-2         | 20% █░░░░░░░| 40% ███░░░░ |
| node-3         | 60% ████░░░░| 80% ██████░ |
| node-4         | 10% ░░░░░░░░| 30% ██░░░░░ |
+---------------------------------------------+
```

#### **3. 命名空间资源分配**

```less
sql复制代码+----------------------------------+
| 命名空间资源分配                             |
+--------------------------------------------+
| 命名空间       | CPU 使用量   | 内存使用量   |
|----------------|-------------|-------------|
| default        | 0.5 核      | 500Mi       |
| kube-system    | 1 核        | 1Gi         |
| app-namespace  | 2 核        | 4Gi         |
+--------------------------------------------+
```

#### **4. 图表展示**

- 使用图表展示资源使用的动态变化（可选）：
  - CPU 和内存使用率的折线图。
  - 节点和命名空间资源使用的柱状图或饼图。

------

### **交互功能**

1. 点击某个节点名称时，可跳转到该节点的详细监控页面（可以单独扩展）。
2. 点击某个命名空间时，可跳转到该命名空间的 Pod 列表页面。

------

### **API 设计**

#### **获取集群监控数据**

- **方法**: `GET /api/monitor`

- 响应

  :

  ```json
  {
    "cluster": {
      "cpuUsage": 40,
      "memoryUsage": 60,
      "nodeCount": 5,
      "namespaceCount": 10
    },
    "nodes": [
      {
        "name": "node-1",
        "cpuUsage": 50,
        "memoryUsage": 70
      },
      {
        "name": "node-2",
        "cpuUsage": 20,
        "memoryUsage": 40
      }
    ],
    "namespaces": [
      {
        "name": "default",
        "cpuUsage": 0.5,
        "memoryUsage": "500Mi"
      },
      {
        "name": "kube-system",
        "cpuUsage": 1,
        "memoryUsage": "1Gi"
      }
    ]
  }
  ```

#### **错误响应**

- 如果集群监控数据获取失败：

  ```json
  {
    "error": "Failed to fetch monitoring data",
    "details": "Kubernetes API connection error"
  }
  ```

------

### **前端逻辑设计**

1. **数据展示**:
   - 使用图表库（如 `ECharts` 或 `Chart.js`）动态渲染 CPU 和内存使用图表。
   - 列表以表格形式展示节点和命名空间详情。
2. **实时刷新**:
   - 每隔 5 秒（可配置）向后端发送请求获取最新监控数据并更新页面。
3. **页面跳转**:
   - 点击节点名称时跳转到节点详情页面（如果扩展）。
   - 点击命名空间名称时跳转到 `/namespaces/{namespace}/pods`。
## **概览页设计**

### **页面内容模块**

概览页主要分为以下几个模块：

1. 集群总览卡片
    - 显示集群的整体健康状态和核心指标（如 CPU、内存、Pod 数量等）。
2. Pod 状态统计
    - 使用图表展示当前集群中 Pod 的状态分布（Running、Pending、Failed）。
3. 节点状态
    - 列出集群中的所有节点及其基本状态（如 Ready 状态、CPU/内存使用率）。
4. 资源使用图表
    - 使用实时更新的折线图显示 CPU 和内存的使用情况趋势。
5. 最近事件
    - 显示最近发生的集群事件，帮助用户快速发现问题。

------

### **字段设计**

#### 1. **集群总览卡片**

显示集群核心的汇总信息，字段包括：

- **集群名称**：如 `MyK8sCluster`
- **总节点数**：当前集群中节点的数量
- **总 Pod 数量**：当前运行中的 Pod 总数
- **总 CPU 使用率**：百分比形式（如 `65%`）
- **总内存使用率**：百分比形式（如 `45%`）
- **异常事件数**：最近一小时的警告和错误事件数量

#### 2. **Pod 状态统计**

以饼图或柱状图展示 Pod 的状态分布：

- **Running**：运行中的 Pod 数量
- **Pending**：挂起的 Pod 数量
- **Failed**：失败的 Pod 数量

#### 3. **节点状态**

列出所有节点的基本信息和状态：

- **节点名称**：如 `node-1`
- **状态**：`Ready` 或 `NotReady`
- **CPU 使用率**：百分比
- **内存使用率**：百分比
- **总 Pod 数量**：该节点上运行的 Pod 数量

#### 4. **资源使用图表**

使用实时折线图展示资源使用情况：

- **CPU 使用率**：每分钟采样一次，显示过去 15 分钟的趋势
- **内存使用率**：同样为每分钟采样，显示趋势

#### 5. **最近事件**

以列表形式展示最新事件：

- **时间戳**：事件发生的时间
- **类型**：`Normal` 或 `Warning`
- **对象**：事件对应的对象（如 Pod、Node）
- **消息**：事件的简短描述

------

### **页面布局设计**

#### 顶部导航栏

- 显示页面标题 `集群概览` 和全局操作菜单（如切换命名空间或登出按钮）。

#### 页面主体布局

```
sql复制代码+--------------------------------------------------------+
| 顶部导航栏                                             |
+--------------------------------------------------------+
| 集群总览卡片                                           |
| +----------------------------------------------------+ |
| | 集群名称: MyK8sCluster   总节点数: 3   总Pod数: 25  | |
| | CPU 使用率: 65%          内存使用率: 45%           | |
| +----------------------------------------------------+ |
+--------------------------------------------------------+
| 左侧 (50%)                | 右侧 (50%)                |
| +------------------------+ | +------------------------+ |
| | Pod 状态统计饼图       | | 节点状态表格            | |
| | - Running: 20          | | - node-1: Ready, 70% CPU | |
| | - Pending: 3           | | - node-2: Ready, 60% CPU | |
| | - Failed: 2            | | - node-3: NotReady       | |
| +------------------------+ | +------------------------+ |
+----------------------------+ +------------------------+ |
| 资源使用图表 (CPU/内存趋势)                             |
| +----------------------------------------------------+ |
| | [折线图：CPU 使用率趋势]                           | |
| | [折线图：内存使用率趋势]                           | |
| +----------------------------------------------------+ |
+--------------------------------------------------------+
| 最近事件列表                                           |
| +----------------------------------------------------+ |
| | 2024-12-12 10:30: Pod example-pod Created          | |
| | 2024-12-12 10:32: Node node-3 NotReady             | |
| +----------------------------------------------------+ |
```

------

### **所需 API**

1. **集群总览数据**

    - API: `GET /api/monitor`

    - 返回字段：

      ```json
      {
        "clusterName": "MyK8sCluster",
        "totalNodes": 3,
        "totalPods": 25,
        "cpuUsage": 65,
        "memoryUsage": 45,
        "warningEvents": 2
      }
      ```

2. **Pod 状态统计**

    - API: `GET /api/pods/status`

    - 返回字段：

      ```json
      {
        "running": 20,
        "pending": 3,
        "failed": 2
      }
      ```

3. **节点状态**

    - API: `GET /api/nodes`

    - 返回字段：

      ```json
      [
        {
          "name": "node-1",
          "status": "Ready",
          "cpuUsage": 70,
          "memoryUsage": 65,
          "totalPods": 12
        },
        {
          "name": "node-2",
          "status": "Ready",
          "cpuUsage": 60,
          "memoryUsage": 55,
          "totalPods": 10
        },
        {
          "name": "node-3",
          "status": "NotReady",
          "cpuUsage": 0,
          "memoryUsage": 0,
          "totalPods": 0
        }
      ]
      ```

4. **资源使用图表**

    - API: `GET /api/monitor/metrics`

    - 返回字段：

      ```json
      {
        "cpuUsageHistory": [60, 63, 65, 67, 66],
        "memoryUsageHistory": [40, 42, 44, 45, 46]
      }
      ```

5. **最近事件**

    - API: `GET /api/events`

    - 返回字段：

      ```json
      [
        {
          "timestamp": "2024-12-12T10:30:00Z",
          "type": "Normal",
          "object": "Pod example-pod",
          "message": "Pod Created"
        },
        {
          "timestamp": "2024-12-12T10:32:00Z",
          "type": "Warning",
          "object": "Node node-3",
          "message": "Node NotReady"
        }
      ]
      ```